:8080 {
  encode gzip zstd

  # Reverse proxy (same-origin) to backend(s).
  # Set at least one of:
  # - QB_UPSTREAM=http://qbittorrent:8080
  # - TR_UPSTREAM=http://transmission:9091
  #
  # Defaults (so Caddy can still start if you forgot to set env vars):
  # - QB_UPSTREAM=http://127.0.0.1:8080
  # - TR_UPSTREAM=http://127.0.0.1:9091
  #
  # Notes:
  # - qB API is /api/v2/*
  # - Transmission RPC is /transmission/rpc
  @qbit path /api/*
  handle @qbit {
    reverse_proxy {$QB_UPSTREAM:http://127.0.0.1:8080}
  }

  @trans path /transmission/*
  handle @trans {
    reverse_proxy {$TR_UPSTREAM:http://127.0.0.1:9091}
  }

  root * /srv
  file_server
}
